
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Adding New Members &#8212; CCF  documentation</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="https://unpkg.com/mermaid@8.4.8/dist/mermaid.min.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using Member Keys Stored in HSM" href="hsm_keys.html" />
    <link rel="prev" title="Common Governance Operations" href="common_member_operations.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

    
    <a class="navbar-brand" href="../index.html">
      <img src="../_static/ccf.svg" class="logo" alt="logo">
    </a>
    
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-11 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../overview/index.html">Overview</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../build_apps/index.html">Build Apps</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../use_apps/index.html">Use Apps</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../operations/index.html">Operations</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="index.html">Governance</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../audit/index.html">Audit</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../contribute/index.html">Contribute</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../glossary.html">Glossary</a>
        </li>
        
        
      </ul>

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/Microsoft/CCF" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<script>
    function onVersionChange() {
      window.location.href = document.getElementById("versions").value;
    }

    window.addEventListener("DOMContentLoaded",function(){
        let selectedVersion = "master"
        const thisURL = window.location.toString()
        let indexOfVersion = thisURL.indexOf("ccf-")
        if (indexOfVersion != -1) {
            selectedVersion = thisURL.substring(indexOfVersion, thisURL.indexOf("/", indexOfVersion));
        }
        let sel = document.getElementById("versions");
        if (sel != null) {
            let opts = sel.options;
            for (var opt, j = 0; opt = opts[j]; j++) {
                if (opt.text == selectedVersion) {
                    sel.selectedIndex = j;
                    break;
                }
            }
        }
    }, false);
</script>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
        

        <ul class="nav bd-sidenav">
            
            
            
            
            
            
            
            
            
            
            
            
            <li class="">
                <a href="proposals.html">Proposing and Voting for a Proposal</a>
            </li>
            
            
            
            <li class="">
                <a href="open_network.html">Opening a Network</a>
            </li>
            
            
            
            <li class="">
                <a href="accept_recovery.html">Accepting Recovery and Submitting Shares</a>
            </li>
            
            
            
            <li class="">
                <a href="common_member_operations.html">Common Governance Operations</a>
            </li>
            
            
            
            <li class="active">
                <a href="">Adding New Members</a>
            </li>
            
            
            
            <li class="">
                <a href="hsm_keys.html">Using Member Keys Stored in HSM</a>
            </li>
            
            
            
            <li class="">
                <a href="member_rpc_api.html">Member RPC API</a>
            </li>
            
            
            
            
            
            
            
            
            
            
        </ul>

        
        <h6> Versions </h6>
        <select name="versions" id="versions" class="custom-select custom-select-sm" style="width:50%" onchange="onVersionChange()">
            <option value="../../master/governance/adding_member.html">master </option>
            <option value="../../ccf-0.17.2/governance/adding_member.html">ccf-0.17.2 </option>
            <option value="../../ccf-0.17.1/governance/adding_member.html">ccf-0.17.1 </option>
            <option value="../../ccf-0.17.0/governance/adding_member.html">ccf-0.17.0 </option>
            <option value="adding_member.html">ccf-0.16.3 </option>
            <option value="../../ccf-0.16.2/governance/adding_member.html">ccf-0.16.2 </option>
            <option value="../../ccf-0.16.1/governance/adding_member.html">ccf-0.16.1 </option>
            <option value="../../ccf-0.16.0/governance/adding_member.html">ccf-0.16.0 </option>
            <option value="../../ccf-0.15.2/index.html">ccf-0.15.2 </option>
            <option value="../../ccf-0.15.1/index.html">ccf-0.15.1 </option>
            <option value="../../ccf-0.15.0/index.html">ccf-0.15.0 </option>
            <option value="../../ccf-0.14.3/index.html">ccf-0.14.3 </option>
            <option value="../../ccf-0.14.2/index.html">ccf-0.14.2 </option>
            <option value="../../ccf-0.14.1/index.html">ccf-0.14.1 </option>
            <option value="../../ccf-0.14.0/index.html">ccf-0.14.0 </option>
            <option value="../../ccf-0.13.4/index.html">ccf-0.13.4 </option>
            <option value="../../ccf-0.13.3/index.html">ccf-0.13.3 </option>
            <option value="../../ccf-0.13.2/index.html">ccf-0.13.2 </option>
            <option value="../../ccf-0.13.1/index.html">ccf-0.13.1 </option>
            <option value="../../ccf-0.13.0/index.html">ccf-0.13.0 </option>
            <option value="../../ccf-0.12.2/index.html">ccf-0.12.2 </option>
            <option value="../../ccf-0.12.1/index.html">ccf-0.12.1 </option>
            <option value="../../ccf-0.12.0/index.html">ccf-0.12.0 </option>
            <option value="../../ccf-0.11.7/index.html">ccf-0.11.7 </option>
            <option value="../../ccf-0.11.4/index.html">ccf-0.11.4 </option>
            <option value="../../ccf-0.11.1/index.html">ccf-0.11.1 </option>
        </select>
        
</nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#generating-member-keys-and-certificates" class="nav-link">Generating Member Keys and Certificates</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#registering-a-new-member" class="nav-link">Registering a New Member</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#activating-a-new-member" class="nav-link">Activating a New Member</a>
        </li>
    
    </ul>
</nav>



<div class="tocsection editthispage">
    <a href="https://github.com/Microsoft/CCF/edit/master/doc/governance/adding_member.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="adding-new-members">
<h1>Adding New Members<a class="headerlink" href="#adding-new-members" title="Permalink to this headline">¶</a></h1>
<p>It is possible for existing members to add new members to the consortium after a CCF network has been started.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The maximum number of allowed active recovery members (i.e. those with a recovery share) at any given time is 255.</p>
</div>
<div class="section" id="generating-member-keys-and-certificates">
<h2>Generating Member Keys and Certificates<a class="headerlink" href="#generating-member-keys-and-certificates" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference internal" href="hsm_keys.html"><span class="doc">Using Member Keys Stored in HSM</span></a> for a guide on how to used member keys and certificate store in Azure Key Vault.</p>
</div>
<p>First, the identity and encryption public and private key pairs of the new member should be created.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">keygenerator.sh</span></code> script can be used to generate the member’s certificate and associated private key as well as their encryption public and private keys.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ keygenerator.sh --name member_name <span class="o">[</span>--gen-enc-key<span class="o">]</span>
-- Generating identity private key and certificate <span class="k">for</span> participant <span class="s2">&quot;member_name&quot;</span>...
Identity curve: secp384r1
Identity private key generated at:   member_name_privk.pem
Identity certificate generated at:   member_name_cert.pem <span class="o">(</span>to be registered <span class="k">in</span> CCF<span class="o">)</span>
<span class="c1"># Only if --gen-enc-key is used:</span>
-- Generating RSA encryption key pair <span class="k">for</span> participant <span class="s2">&quot;member_name&quot;</span>...
Encryption private key generated at:  member_name_enc_privk.pem
Encryption public key generated at:   member_name_enc_pubk.pem <span class="o">(</span>to be registered <span class="k">in</span> CCF<span class="o">)</span>
</pre></div>
</div>
<p>Members that are registered in CCF <cite>with</cite> a public encryption key are recovery members. Each recovery member is given a recovery share (see <a class="reference internal" href="accept_recovery.html#submitting-recovery-shares"><span class="std std-ref">Submitting Recovery Shares</span></a>) that can be used to recover a defunct service. Members registered <cite>without</cite> a public encryption key are not given recovery shares and cannot recover the defunct service.</p>
<p>The member’s identity and encryption private keys (e.g. <code class="docutils literal notranslate"><span class="pre">member_name_privk.pem</span></code> and <code class="docutils literal notranslate"><span class="pre">member_name_enc_privk.pem</span></code>) should be stored on a trusted device (e.g. HSM) while the certificate (e.g. <code class="docutils literal notranslate"><span class="pre">member_name_cert.pem</span></code>) and public encryption key (e.g. <code class="docutils literal notranslate"><span class="pre">member_name_enc_pubk.pem</span></code>) should be registered in CCF by members.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference internal" href="../overview/cryptography.html#algorithms-and-curves"><span class="std std-ref">Algorithms and Curves</span></a> for the list of supported cryptographic curves for member identity.</p>
</div>
</div>
<div class="section" id="registering-a-new-member">
<h2>Registering a New Member<a class="headerlink" href="#registering-a-new-member" title="Permalink to this headline">¶</a></h2>
<p>Once the new member’s keys and certificate have been generated, the existing consortium should register the new member public information in CCF, following the usual propose and vote procedure.</p>
<p>The <a class="reference internal" href="proposals.html#submitting-a-new-proposal"><span class="std std-ref">Submitting a New Proposal</span></a> section describes the steps that members should follow to register a new member.</p>
</div>
<div class="section" id="activating-a-new-member">
<h2>Activating a New Member<a class="headerlink" href="#activating-a-new-member" title="Permalink to this headline">¶</a></h2>
<p>A new member who gets registered in CCF is not yet able to participate in governance operations. To do so, the new member should first acknowledge that they are satisfied with the state of the service (for example, after auditing the current constitution and the nodes currently trusted).</p>
<p>First, the new member should update and retrieve the latest state digest via the <code class="docutils literal notranslate"><span class="pre">/gov/ack/update_state_digest</span></code> endpoint. In doing so, the new member confirms that they are satisfied with the current state of the service.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl https://&lt;ccf-node-address&gt;/gov/ack/update_state_digest  --cacert networkcert.pem --key new_member_privk.pem --cert new_member_cert.pem
<span class="o">{</span>
    <span class="s2">&quot;state_digest&quot;</span>: &lt;...&gt;
<span class="o">}</span>
</pre></div>
</div>
<p>Then, the new member should sign the state digest returned by the <code class="docutils literal notranslate"><span class="pre">/gov/ack/update_state_digest</span></code> via the <code class="docutils literal notranslate"><span class="pre">/gov/ack</span></code> endpoint, using the <code class="docutils literal notranslate"><span class="pre">scurl.sh</span></code> utility:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ scurl.sh https://&lt;ccf-node-address&gt;/gov/ack  --cacert networkcert.pem --key new_member_privk.pem --cert new_member_cert.pem --header <span class="s2">&quot;Content-Type: application/json&quot;</span> --data-binary <span class="s1">&#39;{&quot;state_digest&quot;: &lt;...&gt;}&#39;</span>
<span class="nb">true</span>
</pre></div>
</div>
<p>Once the command completes, the new member becomes active and can take part in governance operations (e.g. creating a new proposal or voting for an existing one).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The newly-activated member is also given a recovery share that can be used <a class="reference internal" href="accept_recovery.html#submitting-recovery-shares"><span class="std std-ref">to recover a defunct service</span></a>.</p>
</div>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="common_member_operations.html" title="previous page">Common Governance Operations</a>
    <a class='right-next' id="next-link" href="hsm_keys.html" title="next page">Using Member Keys Stored in HSM</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2018, Microsoft Research.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.4.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>